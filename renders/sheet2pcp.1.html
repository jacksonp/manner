<!DOCTYPE html>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="man-page-info" data-extra1="PCP" data-extra2="Performance Co-Pilot" data-extra3="">
<title>SHEET2PCP</title>
<h1>SHEET2PCP</h1>
<section>
  <h2>NAME</h2>
  <p><strong>sheet2pcp</strong> - import spreadsheet data and create a PCP archive
</section>
<section>
  <h2>SYNOPSIS</h2>
  <p><strong>sheet2pcp</strong> [<strong>-h</strong> <em>host</em>] [<strong>-Z</strong> <em>timezone</em>] <em>infile</em> <em>mapfile</em> <em>outfile</em>
</section>
<section>
  <h2>DESCRIPTION</h2>
  <p><strong>sheet2pcp</strong> is intended to read a data spreadsheet (<em>infile</em>) translate this into a Performance Co-Pilot (PCP) archive with the basename <em>outfile</em>.
  <p>The input spreadsheet can be in any of the common formats, provided the appropriate Perl modules have been installed (see the <strong>CAVEATS</strong> section below). The spreadsheet must be normalized so that each row contains data for the same time interval, and one of the columns contains the date and time for the data in each row.
  <p>The resultant PCP archive may be used with all the PCP client tools to graph subsets of the data using <strong>pmchart</strong>(1), perform data reduction and reporting, filter with the PCP inference engine <strong>pmie</strong>(1), etc.
  <p>The <em>mapfile</em> controls the import process and defines the data mapping from the spreadsheet columns onto the PCP data model. The file is written in XML and conforms to the syntax defined in the <strong>MAPPING CONFIGURATION</strong> section below.
  <p>A series of physical files will be created with the prefix <em>outfile</em>. These are <em>outfile</em><strong>.0</strong> (the performance data), <em>outfile</em><strong>.meta</strong> (the metadata that describes the performance data) and <em>outfile</em><strong>.index</strong> (a temporal index to improve efficiency of replay operations for the archive). If any of these files exists already, then <strong>sheet2pcp</strong> will <strong>not</strong> overwrite them and will exit with an error message.
  <p>The <strong>-h</strong> option is an alternate to the <strong>hostname</strong> attribute of the <strong>&lt;sheet&gt;</strong> element in <em>mapfile</em> described below. If both are specified, the value from <em>mapfile</em> is used.
  <p>The <strong>-Z</strong> option is an alternate to the <strong>timezone</strong> attribute of the <strong>&lt;sheet&gt;</strong> element in <em>mapfile</em> described below. If both are specified, the value from <em>mapfile</em> is used.
  <p><strong>sheet2pcp</strong> is a Perl script that uses the PCP::LogImport Perl wrapper around the PCP <em>libpcp_import</em> library, and as such could be used as an example to develop new tools to import other types of performance data and create PCP archives.
</section>
<section>
  <h2>MAPPING CONFIGURATION</h2>
  <p>The <em>mapfile</em> contains specifications in standard XML format.
  <p>The whole specification is wrapped in a <strong>&lt;sheet&gt;</strong> ... <strong>&lt;/sheet&gt;</strong> element. The <strong>sheet</strong> tag supports the following optional attributes:
  <dl class="indent-10">
    <dt><strong>heading</strong>
    <dd>
      <p>Specifies the number of heading rows to skip at the start of the spreadsheet before processing data. Example: heading=1.
    <dt><strong>hostname</strong>
    <dd>
      <p>Set the source hostname in the PCP archive (the default is to use the hostname of the local host). Example: hostname=some.where.com.
    <dt><strong>timezone</strong>
    <dd>
      <p>Set the source timezone in the PCP archive (the default is to use UTC). The timezone must have the format +HHMM (for hours and minutes East of UTC) or -HHMM (for hours and minutes West of UTC). Note in particular that <strong>neither</strong> the <strong>zoneinfo</strong> (aka Olson) format, e.g. Europe/Paris, nor the Posix <strong>TZ</strong> format, e.g. EST+5 is allowed. Example: timezone=+1100.
    <dt><strong>datefmt</strong>
    <dd>
      <p>The format of the date imported from the spreadsheet may be specified as a concatenation of values that specify the order of the year (<strong>Y</strong>), month (<strong>M</strong>) and day (<strong>D</strong>) fields in a date. The supported variants are <strong>DMY</strong> (the default), <strong>MDY</strong> and <strong>YMD</strong>. Example: datefmt=YMD.
  </dl>
  <p>A <strong>&lt;sheet&gt;</strong> element contains one or more metric specifications of the form <strong>&lt;metric&gt;</strong><em>metricname</em><strong>&lt;/metric&gt;</strong>. The <strong>metric</strong> tag supports the following optional attributes:
  <dl class="indent-10">
    <dt><strong>pmid</strong>
    <dd>
      <p>The Performance Metrics Identifier (PMID), specified as 3 numbers separated by a periods (.) to set the <strong>domain</strong>, <strong>cluster</strong> and <strong>item</strong> fields of the PMID, see <strong>PMNS</strong>(5) for more details of PMIDs. If omitted, the PMID will be automatically assigned by <strong>pmiAddMetric</strong>(3). The value <strong>PM_ID_NULL</strong> may be used to explicitly nominate the default behaviour. Examples: pmid=60.0.2, pmid=PM_ID_NULL.
    <dt><strong>indom</strong>
    <dd>
      <p>Each metric may have one or more values. If a metric <strong>always</strong> has one value, it is singular and the Instance Domain should be set to <strong>PM_INDOM_NULL</strong>. Otherwise <strong>indom</strong> should be specified as 2 numbers separated by a period (.) to set the <strong>domain</strong> and <strong>ordinal</strong> fields of the Instance Domain, see the <strong>__pmInDom_int</strong> typedef in <em>&lt;pcp/impl.h&gt;</em>. Examples: indom=PM_INDOM_NULL, indom=60.3, indom=PMI_DOMAIN.4. More than one metric can share the same Instance Domain when the metrics have defined values over similar sets of instances, e.g. all the metrics for each network interface. It is standard practice for the <strong>domain</strong> field to be the same for the <strong>pmid</strong> and the <strong>indom</strong>; if the <strong>pmid</strong> attribute is missing, then the <strong>domain</strong> field for the <strong>indom</strong> should be the reserved domain <strong>PMI_DOMAIN</strong>. If the <strong>indom</strong> attribute is omitted then the default Instance Domain for the metric is <strong>PM_INDOM_NULL</strong>.
    <dt><strong>units</strong>
    <dd>
      <p>The scale and dimension of the metric values along the axes of space, time and count (events, messages, packets, etc.) is specified with a 6-tuple. These values are passed to the <strong>pmiUnits</strong>(3) function to generate a <em>pmUnits</em> structure. Refer to <strong>pmLookupDesc</strong>(3) for a full description of all the fields of this structure. The default is to assign no scale or dimension to the metric, i.e. units=0,0,0,0,0,0. Examples: units=0,1,0,0,PM_TIME_MSEC,0 (milliseconds), units=1,-1,0,PM_SPACE_MBYTE,PM_TIME_SEC,0 (Mbytes/sec), units=0,1,-1,0,PM_TIME_USEC,PM_COUNT_ONE (microseconds/event).
    <dt><strong>type</strong>
    <dd>
      <p>Defines the data type for the metric. Refer to <strong>pmLookupDesc</strong>(3) for a full description of the possible type values; the default is <strong>PM_TYPE_FLOAT</strong>. Examples: type=PM_TYPE_32, type=PM_TYPE_U64, type=PM_TYPE_STRING.
    <dt><strong>sem</strong>
    <dd>
      <p>Defines the semantics of the metric. Refer to <strong>pmLookupDesc</strong>(3) for a full description of the possible values; the default is <strong>PM_SEM_INSTANT</strong>. Examples: sem=PM_SEM_COUNTER, type=PM_SEM_DISCRETE.
  </dl>
  <p>The remaining specifications define the data columns <strong>in order</strong> using <strong>exactly</strong> one <strong>&lt;datetime&gt;</strong><strong>&lt;/datetime&gt;</strong> element, one or more <strong>&lt;data&gt;</strong><em>metricspec</em><strong>&lt;/data&gt;</strong> elements and one or more <strong>&lt;skip&gt;</strong><strong>&lt;/skip&gt;</strong> elements.
  <p>The <strong>&lt;datetime&gt;</strong> element defines the column in which a date and time will be found to form the timestamp in the PCP archive for all the data in each row of the PCP archive.
  <p>For the <strong>&lt;data&gt;</strong> element, a <em>metricspec</em> consists of a metric name (as defined in an earlier <strong>&lt;metric&gt;</strong> element), optionally followed by an instance name that is enclosed by square brackets, e.g. &lt;data&gt;hinv.ncpu&lt;/data&gt;, &lt;data&gt;kernel.all.load[1 minute]&lt;/data&gt;.
  <p>The <strong>skip</strong> tag defines the column that should be skipped when preparing data for the PCP archive.
  <p>The order of the <strong>&lt;datetime&gt;</strong>, <strong>&lt;data&gt;</strong> and <strong>&lt;skip&gt;</strong> elements matches the order of columns in the spreadsheet. If the number of elements is not the same as the number of columns a warning is issued, and the extra elements or columns generate no metric values in the output archive.
  <section>
    <h3>EXAMPLE</h3>
    <p>The <em>mapfile</em> ...
    <pre>    &lt;?xml version="1.0" encoding="UTF-8"?&gt;
    &lt;sheet heading="1"&gt;
        &lt;!-- simple example --&gt;
        &lt;metric pmid="60.0.2" indom="60.0" units="0,1,0,0,PM_TIME_MSEC,0"
            type="PM_TYPE_U64" sem="PM_SEM_COUNTER"&gt;
        kernel.percpu.cpu.sys&lt;/metric&gt;
        &lt;datetime&gt;&lt;/datetime&gt;
        &lt;skip&gt;&lt;/skip&gt;
        &lt;data&gt;kernel.percpu.cpu.sys[cpu0]&lt;/data&gt;
        &lt;data&gt;kernel.percpu.cpu.sys[cpu1]&lt;/data&gt;
    &lt;/sheet&gt;</pre>
    <p>could be used for a spreadsheet in which the first few rows are ...
    <pre>    Date;"Status";"SysTime - 0";"SysTime - 1";
    26/01/2001 14:05:22;"Some Busy";0.750;0.133
    26/01/2001 14:05:37;"OK";0.150;0.273
    26/01/2001 14:05:52;"All Busy";0.733;0.653</pre>
  </section>
</section>
<section>
  <h2>CAVEATS</h2>
  <p>Only the first sheet from <em>infile</em> will be processed.
  <p>Additional Perl modules must be installed for the various spreadsheet formats, although these are checked for ar run-time so only the modules required for the specific types of spreadsheets you wish to process need be installed:
  <dl class="indent-6">
    <dt><strong>*.csv</strong>
    <dd>
      <p>Spreadsheets in the Comma Separated Values (CSV) format require <strong>Text::CSV_XS</strong>(3pm).
    <dt><strong>*.sxc</strong> or <strong>*.ods</strong>
    <dd>
      <p>OpenOffice documents require <strong>Spreadsheet::ReadSXC</strong>(3pm), which in turn requires <strong>Archive::Zip</strong>(3pm).
    <dt><strong>*.xls</strong>
    <dd>
      <p>Classical Microsoft Office documents require <strong>Spreadsheet::ParseExcel</strong>(3pm), which in turn requires <strong>OLE::Storage_Lite</strong>(3pm).
    <dt><strong>*.xlsx</strong>
    <dd>
      <p>Microsoft OpenXML documents require <strong>Spreadsheet::XLSX</strong>(3pm). <strong>sheet2pcp</strong> does not appear to work with OpenXML documents saved from OpenOffice.
  </dl>
</section>
<section>
  <h2>PCP ENVIRONMENT</h2>
  <p>Environment variables with the prefix <strong>PCP_</strong> are used to parameterize the file and directory names used by PCP. On each installation, the file <em>/etc/pcp.conf</em> contains the local values for these variables. The <strong>$PCP_CONF</strong> variable may be used to specify an alternative configuration file, as described in <strong>pcp.conf</strong>(5).
</section>
<section>
  <h2>SEE ALSO</h2>
  <p><strong>pmchart</strong>(1), <strong>pmie</strong>(1), <strong>pmlogger</strong>(1), <strong>sed</strong>(1), <strong>pmiAddMetric</strong>(3), <strong>pmLookupDesc</strong>(3), <strong>pmiUnits</strong>(3), <strong>Archive::Zip</strong>(3pm), <strong>Date::Format</strong>(3pm), <strong>Date::Parse</strong>(3pm), <strong>PCP::LogImport</strong>(3pm), <strong>OLE::Storage_Lite</strong>(3pm), <strong>Spreadsheet::ParseExcel</strong>(3pm), <strong>Spreadsheet::ReadSXC</strong>(3pm), <strong>Spreadsheet::XLSX</strong>(3pm), <strong>Text::CSV_XS</strong>(3pm), <strong>XML::TokeParser</strong>(3pm) and <strong>LOGIMPORT</strong>(3).
</section>

