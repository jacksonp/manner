<!DOCTYPE html>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="man-page-info" data-date="" data-package="Version @catdoc_version@" data-section-name="MS-Word reader">
<title>catdoc</title>
<h1>catdoc</h1>
<p>catdoc - reads MS-Word file and puts its content as plain text on standard output
<div class="section">
  <h2>SYNOPSIS</h2>
  <p><strong>catdoc</strong> [<strong>-vlu8btawxV</strong>] [<strong>-m</strong> <em>number</em>] [ <strong>-s</strong> <em>charset</em>] [ <strong>-d</strong> <em>charset</em>] [ <strong>-f</strong> <em>output-format</em>] <em>file</em>
</div>
<div class="section">
  <h2>DESCRIPTION</h2>
  <p><strong>catdoc</strong> behaves much like <a href="/1/cat" class="link-man">cat(1)</a> but it reads MS-Word file and produces human-readable text on standard output. Optionally it can use <a href="/1/latex" class="link-man">latex(1)</a> escape sequences for characters which have special meaning for LaTeX. It also makes some effort to recognize MS-Word tables, although it never tries to write correct headers for LaTeX tabular environment. Additional output formats, such is HTML can be easily defined.
  <p><strong>catdoc</strong> doesn't attempt to extract formatting information other than tables from MS-Word document, so different output modes means mainly that different characters should be escaped and different ways used to represent characters, missing from output charset. See CHARACTER SUBSTITUTION below
  <p><strong>catdoc</strong> uses internal <a href="/7/unicode" class="link-man">unicode(7)</a> representation of text, so it is able to convert texts when charset in source document doesn't match charset on target system. See CHARACTER SETS below.
  <p>If no file names supplied, <strong>catdoc</strong> processes its standard input unless it is terminal. It is unlikely that somebody could type Word document from keyboard, so if <strong>catdoc</strong> invoked without arguments and stdin is not redirected, it prints brief usage message and exits. Processing of standard input (even among other files) can be forced using dash '-' as file name.
  <p>By default, <strong>catdoc</strong> wraps lines which are more than 72 chars long and separates paragraphs by blank lines. This behavior can be turned of by <strong>-w</strong> switch. In <em>wide</em> mode <strong>catdoc prints each paragraph as one long line, suitable for import into</strong> word processors which perform word wrapping.
</div>
<div class="section">
  <h2>OPTIONS</h2>
  <dl>
    <dt><strong>-a</strong>
    <dd>- shortcut for -f ascii. Produces ASCII text as output. Separates table columns with TAB
    <dt><strong>-b</strong>
    <dd>- process broken MS-Word file. Normally, <strong>catdoc checks if first 8 bytes</strong> of file is Microsoft OLE signature. If so, it processes file, otherwise it just copies it to stdin. It is intended to use <strong>catdoc</strong> as filter for viewing all files with <em>.doc</em> extension.
    <dt><strong>-d</strong><em>charset</em>
    <dd>- specifies destination charset name. Charset file has format described in CHARACTER SETS below and should have <strong>.txt</strong> extension and reside in <strong>catdoc library directory ( @libdir@/catdoc). By default, current</strong> locale charset is used if langinfo support compiled in.
    <dt><strong>-f</strong><em>format</em>
    <dd>- specifies output format as described in CHARACTER SUBSTITUTION below. <strong>catdoc</strong> comes with two output formats - ascii and tex. You can add your own if you wish.
    <dt><strong>-l</strong>
    <dd>Causes <strong>catdoc</strong> to list names of available charsets to the stdout and exit successfully.
    <dt><strong>-m</strong><em>number</em>
    <dd>Specifies right margin for text (default 72). <strong>-m 0</strong> is equivalent to <strong>-w</strong>
    <dt><strong>-s</strong><em>charset</em>
    <dd>Specifies source charset. (one used in Word document), if Word document doesn't contain UTF-16 text. When reading rtf documents, it is typically not necessary, because rtf documents contain ansicpg specification. But it can be set wrong by Word (I've seen RTF documents on Russian, where cp1252 was specified). In this case this option would take precedence over charset, specified in the document. But source_charset statement in the configuration file have less priority than charset in the document.
    <dt><strong>-t</strong>
    <dd>
      - shortcut for <strong>-f tex</strong> converts all printable chars, which have special meaning for <a href="/1/LaTeX" class="link-man">LaTeX(1)</a> into appropriate control sequences. Separates table columns by <strong>&amp;.</strong>
    <dt><strong>-u</strong>
    <dd>- declares that Word document contain UNICODE (UTF-16) representation of text (as some Word-97 documents). If catdoc fails to correct Word document with default charset, try this option.
    <dt><strong>-8</strong>
    <dd>- declares is Word document is 8 bit. Just in case that catdoc recognizes file format incorrectly.
    <dt><strong>-w</strong>
    <dd>disables word wrapping. By default <strong>catdoc</strong> output is split into lines not longer than 72 (or number, specified by -m option) characters and paragraphs are separated by blank line. With this option each paragraph is one long line.
    <dt><strong>-x</strong>
    <dd>causes catdoc to output unknown UNICODE character as \xNNNN, instead of question marks.
    <dt><strong>-v</strong>
    <dd>causes catdoc to print some useless information about word document structure to stdout before actual start of text.
    <dt><strong>-V</strong>
    <dd>outputs catdoc version
  </dl>
</div>
<div class="section">
  <h2>CHARACTER SETS</h2>
  <p>When processing MS-Word file <strong>catdoc</strong> uses information about two character sets, typically different - input and output. They are stored in plain text files in <strong>catdoc</strong> data directory. Character set files should contain two whitespace-separated hexadecimal numbers - 8-bit code in character set and 16-bit Unicode code. Anything from hash mark to end of line is ignored, as well as blank lines.
  <p><strong>catdoc</strong> distribution includes some of these character sets. Additional character set definitions, directly usable by <strong>catdoc</strong> can be obtained from ftp.unicode.org. Charset files have <strong>.txt</strong> suffix, which shouldn't be specified in command-line or configuration files.
  <p>Note that <strong>catdoc</strong> is distributed with Cyrillic charsets as default. If you are not Russian, you probably don't want it, an should reconfigure catdoc at compile time or in runtime configuration file.
  <p>When dealing with documents with charsets other than default, remember that Microsoft never uses ISO charsets. While letters in, say cp1252 are at the same position as in ISO-8859-1, some punctuation signs would be lost, if you specify ISO-8859-1 as input charset. If you use cp1252, catdoc would deal with those signs as described in CHARACTER SUBSTITUTION below.
</div>
<div class="section">
  <h2>CHARACTER SUBSTITUTION</h2>
  <p><strong>catdoc</strong> converts MS-Word file into following internal Unicode representation:
  <dl>
    <dt>1. Paragraphs are separated by ASCII Line Feed symbol (0x000A)
    <dt>2. Table cells within row are separated by ASCII Field Separator symbol
    <dd>(0x001C)
    <dt>3. Table rows are separated by ASCII Record Separator (0x001E)
    <dt>4. All printable characters, including whitespace are represented with their
    <dd>respective UNICODE codes.
  </dl>
  <p>This UNICODE representation is subsequently converted into 8-bit text in target character set using following four-step algorithm:
  <dl>
    <dt>1. List of special characters is searched for given Unicode character.
    <dd>If found, then appropriate multi-character sequence is output instead of character.
    <dt>2. If there is an equivalent in target character set, it is output.
    <dt>3. Otherwise, replacement list is searched and, if there is multi-character
    <dd>substitution for this UNICODE char, it is output.
    <dt>4. If all above fails, "Unknown char" symbol (question mark) is output.
  </dl>
  <p>Lists of special characters and list of substitution are character set-independent, because special chars should be escaped regardless of their existence in target character set (usually, they are parts of US-ASCII, and therefore exist in any character set) and replacement list is searched only for those characters, which are not found in target character set.
  <p>These lists are stored in <strong>catdoc</strong> data directory in files with prefix of format name. These files have following format:
  <p>Each line can be either comment (starting with hash mark) or contain hexadecimal UNICODE value, separated by whitespace from string, which would be substituted instead of it. If string contain no whitespace it can be used as is, otherwise it should be enclosed in single or double quotes. Usual backslash sequences like <em>'\n'</em>,<em>'\t'</em> can be used in these string.
</div>
<div class="section">
  <h2>RUNTIME CONFIGURATION</h2>
  <p>Upon startup catdoc reads its system-wide configuration file <strong>/etc/catdocrc and then</strong> user-specific configuration file <strong>${HOME}/.catdocrc.</strong>
  <p>These files can contain following directives:
  <dl>
    <dt><strong>source_charset =</strong> <em>charset-name</em>
    <dd>Sets default source charset, which would be used if no <strong>-s</strong> option specified. Consult configuration of nearby windows workstation to find one you need.
    <dt><strong>target_charset =</strong> <strong>charset-name</strong>
    <dd>Sets default output charset. You probably know, which one you use.
    <dt><strong>charset_path =</strong> <strong>directory-list</strong>
    <dd>colon-separated list of directories, which are searched for charset files. This allows you to install additional charsets in your home directory. If first directory component of path is ~ it is replaced by contents of <strong>HOME</strong> environment variable. On MS-DOS platform, if directory name starts with %s, it is replaced with directory of executable file. Empty element in list (i.e. two consequitve colons) is considered current directory.
    <dt><strong>map_path =</strong> <em>directory-list</em>
    <dd>colon-separated list of directories, which are searched for special character map and replacement map. Same substitution rules as in <strong>charset_path</strong> are applied.
    <dt><strong>format =</strong> <em>format name</em>
    <dd>Output format which would be used by default. <strong>catdoc</strong> comes with two formats - <strong>ascii</strong> and <strong>tex</strong> but nothing prevents you from writing your own format (set two map files - special character map and replacement map).
    <dt><strong>unknown_char =</strong> <em>character specification</em>
    <dd>sets character to output instead of unknown Unicode character (default '?') Character specification can have one of two form - character enclosed in single quotes or hexadecimal code.
    <dt><strong>use_locale =</strong><em>(yes|no)</em>
    <dd>Enables or disables automatic selection of output charset (default <strong>yes</strong>), based on system locale settings (if enabled at compile time). If automatic detection is enabled, than output charset settings in the configuration files (but not in the command line) are ignored, and current system locale charset is used instead. There are no automatic choice of input charset, based of locale language, because most modern Word files (since Word 97) are Unicode anyway
  </dl>
</div>
<div class="section">
  <h2>BUGS</h2>
  <p>Doesn't handle fast-saves properly. Prints footnotes as separate paragraphs at the end of file, instead of producing correct LaTeX commands. Cannot distinguish between empty table cell and end of table row.
</div>
<div class="section">
  <h2>SEE ALSO</h2>
  <p><a href="/1/xls2csv" class="link-man">xls2csv(1)</a>, <a href="/1/cat" class="link-man">cat(1)</a>, <a href="/1/strings" class="link-man">strings(1)</a>, <a href="/4/utf" class="link-man">utf(4)</a>, <a href="/7/unicode" class="link-man">unicode(7)</a>
</div>
<div class="section">
  <h2>AUTHOR</h2>
  <p>V.B.Wagner &lt;vitus@45.free.net&gt;
</div>

