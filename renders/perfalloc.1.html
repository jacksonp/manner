<!DOCTYPE html>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="man-page-info" data-date="PCP" data-package="Performance Co-Pilot" data-section-name="">
<title>PERFALLOC</title>
<h1>PERFALLOC</h1>
<div class="section">
  <h2>NAME</h2>
  <p><strong>perfalloc</strong> - notify <a href="/1/pmdaperfevent" class="link-man">pmdaperfevent(1)</a> to disable hardware counter allocation.
</div>
<div class="section">
  <h2>SYNOPSIS</h2>
  <p><strong>$PCP_PMDAS_DIR/perfevent/perfalloc</strong> [<strong>-D</strong>] [<strong>-d</strong>] [<strong>-f</strong> <em>lockfile</em>] [<strong>-h</strong>] [<strong>-v</strong>] [<strong>COMMAND</strong>]
</div>
<div class="section">
  <h2>DESCRIPTION</h2>
  <p><strong>perfalloc</strong> is a command that notifies the <a href="/1/pmdaperfevent" class="link-man">pmdaperfevent(1)</a> to disable hardware counter event collection. This allow unprivileged processes to use the hardware counters.
  <p>If the reservation request fails, then perfalloc exits immediately with exit code EXIT_FAILURE. If successful, the perfalloc will run until a kill signal is received. The reservation request persists while perfalloc is running.
  <p>Note that <strong>pmdaperfevent</strong> is affected by the value of the <em>kernel.perf_event_paranoid</em> setting, which can be adjusted by <a href="/8/sysctl" class="link-man">sysctl(8)</a>.
  <p>If a commandline is given, this is executed as a subprocess of the agent. When the command dies, so does the agent.
  <p>A brief description of the command line options follows:
  <dl>
    <dt><strong>-D</strong>
    <dd>run in the foreground (the default)
    <dt><strong>-d</strong>
    <dd>run in the background
    <dt><strong>-f FILE</strong>
    <dd>use FILE as the lock file (default $PCP_PMDAS_DIR/perfevent/perflock)
    <dt><strong>-h</strong>
    <dd>display a help message and exit
    <dt><strong>-v</strong>
    <dd>output version number and exit
  </dl>
</div>
<div class="section">
  <h2>BUGS</h2>
  <p>There may be a delay of up to 100 miliseconds between perfalloc requesting the hardware counter disabling and the perfevent pmda processing the request.
  <p>The perfalloc process does not check the status of the request and therefore is not able to provide a positive confirmation that the request succeeded and the hardware counters are disabled.
</div>
<div class="section">
  <h2>SEE ALSO</h2>
  <p><a href="/1/pmdaperfevent" class="link-man">pmdaperfevent(1)</a>, <a href="/3/perfevent.conf" class="link-man">perfevent.conf(3)</a> and <a href="/8/sysctl" class="link-man">sysctl(8)</a>.
</div>

